!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([,function(e,t){!function(){"use strict";var e,t,r,n=0;document.addEventListener("DOMContentLoaded",(function(n){e=document.getElementById("zakeke-composer-frame"),t=document.getElementById("zakeke-composer-container"),r={zakekeExchangeRates:JSON.parse(t.getAttribute("zakeke-exchange-rates")),zakekeUnitPrices:JSON.parse(t.getAttribute("zakeke-unit-prices")),zakekeUrl:t.getAttribute("zakeke-url"),zakekeProductName:t.getAttribute("zakeke-product-name"),zakekeCurrency:t.getAttribute("zakeke-currency"),zakekeCulture:t.getAttribute("zakeke-culture").replace("_","-"),zakekeModelCode:t.getAttribute("zakeke-model-code"),zakekeQty:t.getAttribute("zakeke-qty"),zakekeCustomer:t.getAttribute("zakeke-customer"),zakekeGuest:t.getAttribute("zakeke-guest"),zakekeAttributes:JSON.parse(t.getAttribute("zakeke-attributes")),zakekeToken:t.getAttribute("zakeke-token"),zakekeCartShowUrl:t.getAttribute("zakeke-cart-show-url"),zakekeZakCartShowUrl:t.getAttribute("zakeke-zak-cart-show-url"),zakekeTaxPolicy:parseInt(t.getAttribute("zakeke-tax-policy")),zakekeTaxRate:Number(t.getAttribute("zakeke-tax-rate")),zakekeCurrencyBase:t.getAttribute("zakeke-currency-base")},a(r)}));var a=function(t){var r=o(t);e.src=r,window.addEventListener("message",u(t),!1)},o=function(e){var t=e.zakekeUrl+"/Customizer/";!function(){var e=!0;window.matchMedia("(min-width: 48em)").matches&&(e=!1);return e}()?t+="index.html?":t+="index.mobile.html?";var r=i(e);return t=(t=t+"name="+e.zakekeProductName+"&modelCode="+e.zakekeModelCode)+"&qty="+e.zakekeQty+"&taxPricesPolicy=hidden&culture="+e.zakekeCulture+"&ecommerce=ccloud&currency="+e.zakekeCurrency,r&&(t=t+"&"+r),t=t+"&isClientPreviewsEnabled=1&tokenOwin="+e.zakekeToken+"&shareUrlPrefix=",console.log("IFrameUrl:"+t),encodeURI(t)},i=function(e){var t="";return e.zakekeAttributes.forEach((function(e,r){var n=e[0].id,a=e[1].id;t=0==r?"attribute["+n+"]="+a:t+"&attribute["+n+"]="+a})),t};var u=function(e){return function(t){var r=e.zakekeUrl+"/";t.origin===r.slice(0,-1)&&(0===t.data.zakekeMessageType?p(t.data):1===t.data.zakekeMessageType&&k(t.data))}},c=0,k=function(t){if(c<=10)c++;else{var a=t.design.price,o=t.design.percentPrice,i=JSON.parse(t.design.color),u=parseInt(r.zakekeQty);console.log("Composition price request= "+a),console.log("Composition percentPrice request= "+o);var k=s(i)[0].price,l=0,d=0,p=0;a>0?(d=f(l=a),p=z(d)):p=d=f(l=k*o/100*u),n=p,console.log("Composition price tot= "+l),console.log("Composition price tot= "+p);var g={color:i,isOutOfStock:!1,finalPrice:k*u+p};e.contentWindow.postMessage({data:g,zakekeMessageType:1},"*")}},s=function(e){var t=l(e),n=null;if(0==t.length)n=r.zakekeUnitPrices;else{var a=d(t);n=[r.zakekeUnitPrices.find((function(e){for(var t=!0,r=d(e.option),n=Object.keys(a),o=0;o<n.length;o++){var i=n[o];if(r[i]!=a[i]){t=!1;break}t=!0}return t}))]}return n},l=function(e){return e.map((function(e,t){return{optionID:e.Id,valueID:e.Value.Id}}))},d=function(e){return e.map((function(e){var t=e.optionID,r=e.valueID,n={};return n[t]=r,n})).reduce((function(e,t,r){var n=Object.keys(t)[0],a=Object.values(t)[0];return 0===r?e={}:e[n]=a,e}))},f=function(e){var t=r.zakekeTaxPolicy,n=r.zakekeTaxRate;return 1==t?e:e+e*n/100},z=function(e){var t=r.zakekeCurrency;r.zakekeCurrencyBase;return e*r.zakekeExchangeRates[t]},p=function(e){var t=e.designId,a=JSON.parse(e.colorId),o=parseInt(r.zakekeQty),i=n,u=s(a),c=l(a),k=new g(u,i,o,t,"",c);m(k).then(e=>{"OK"==e.status?(console.log("OK - addCart SUCCESS"),window.location.href=r.zakekeCartShowUrl):console.log("ERROR: "+e.message)})},g=function(e,t,r,n,a,o){this.productID=e[0].productID,this.quantity=r,this.compositionPrice=t,this.compositionID=n,this.compositionPreview=a,this.zakOptions=o,this.customizationType=1,this.platformType=2},m=function(e){var t=r.zakekeZakCartShowUrl;return fetch(t,{method:"POST",body:JSON.stringify(e)}).then(e=>{if(e.ok)return e.json()}).then(e=>e).catch(e=>console.error(e.message))}}()}]);