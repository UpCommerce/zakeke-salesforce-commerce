!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){!function(){"use strict";var e,t,n=0,o=JSON.parse(document.getElementById("zakeke-composer-container").getAttribute("zakeke-exchange-rates")),r=JSON.parse(document.getElementById("zakeke-composer-container").getAttribute("zakeke-unit-prices")),a=document.getElementById("zakeke-composer-container").getAttribute("zakeke-url"),c=document.getElementById("zakeke-composer-container").getAttribute("zakeke-product-name"),i=document.getElementById("zakeke-composer-container").getAttribute("zakeke-currency"),u=document.getElementById("zakeke-composer-container").getAttribute("zakeke-culture").replace("_","-"),s=document.getElementById("zakeke-composer-container").getAttribute("zakeke-model-code"),d=document.getElementById("zakeke-composer-container").getAttribute("zakeke-qty"),m=document.getElementById("zakeke-composer-container").getAttribute("zakeke-customer"),l=document.getElementById("zakeke-composer-container").getAttribute("zakeke-guest"),k=JSON.parse(document.getElementById("zakeke-composer-container").getAttribute("zakeke-attributes")),p=document.getElementById("zakeke-composer-container").getAttribute("zakeke-token"),g=document.getElementById("zakeke-composer-container").getAttribute("zakeke-cart-show-url"),f=document.getElementById("zakeke-composer-container").getAttribute("zakeke-zak-cart-show-url"),y=parseInt(document.getElementById("zakeke-composer-container").getAttribute("zakeke-tax-policy")),b=Number(document.getElementById("zakeke-composer-container").getAttribute("zakeke-tax-rate"));document.getElementById("zakeke-composer-container").getAttribute("zakeke-currency-base");document.addEventListener("DOMContentLoaded",(function(t){(e=document.getElementById("zakeke-composer-frame")).src=a+"/Configurator/index.html",function(){var e={name:c,currency:i,culture:u,modelCode:s,compositionId:"",qty:d,ecommerce:"ccloud",guest:l,attributes:k,zakekeUrl:a+"/",token:p};"0"!==m&&(e={name:c,currency:i,culture:u,modelCode:s,compositionId:"",qty:d,ecommerce:"ccloud",customer:m,attributes:k,zakekeUrl:a+"/",token:p});z(e)}()}));var z=function(n){var o;o=e,t=setInterval((function(){var e=Object.assign({},n);console.log("Send load to plugin"),o.contentWindow.postMessage({type:"load",parameters:e},"*")}),500),window.addEventListener("message",v(),!1)},v=function(){return function(e){var n=a+"/";e.origin===n.slice(0,-1)&&("AddToCart"===e.data.zakekeMessageType?I(e.data):"Price"===e.data.zakekeMessageType?C(e.data):"Close"===e.data.zakekeMessageType||"loaded"===e.data.zakekeType&&clearInterval(t))}},I=function(e){var t=e.message.composition,o=e.message.preview,r=(e.message.preview,e.message.attributes),a=parseInt(e.message.quantity),c=n,i=B(r),u=E(r),s=new O(i,c,a,t,o,u);h(s).then(e=>{"OK"==e.status?(console.log("OK - addCart SUCCESS"),window.location.href=g):console.error("ERROR: "+e.message)})},O=function(e,t,n,o,r,a){this.productID=e[0].productID,this.quantity=n,this.compositionPrice=t,this.compositionID=o,this.compositionPreview=r,this.zakOptions=a,this.customizationType=2,this.platformType=2},h=function(e){return fetch(f,{method:"POST",body:JSON.stringify(e)}).then(e=>{if(e.ok)return e.json()}).then(e=>e).catch(e=>console.error(e.message))},E=function(e){return e.filter((function(e){return 0==w(e.attributeCode)})).map((function(e,t){return{optionID:e.attributeCode,valueID:e.optionCode}}))},A=function(e){return e.map((function(e){var t=e.optionID,n=e.valueID,o={};return o[t]=n,o})).reduce((function(e,t,n){var o=Object.keys(t)[0],r=Object.values(t)[0];return 0===n?e={}:e[o]=r,e}))},B=function(e){var t=e.filter((function(e){return w(e.attributeCode)})).map((function(e,t){var n=JSON.parse(e.attributeCode),o=JSON.parse(e.optionCode);return{optionID:n.id,valueID:o.id}})),n=null;if(0==t.length)n=r;else{var o=A(t);n=[r.find((function(e){for(var t=!0,n=A(e.option),r=Object.keys(n),a=0;a<r.length;a++){var c=r[a];if(n[c]!=o[c]){t=!1;break}t=!0}return t}))]}return n},C=function(t){var n=t.message.attributes,o=t.message.quantity,r=t.message.compositionPrice,a=B(n),c=S(r);console.log("Composition price selected: ",r),console.log("Quantity selected: ",o),console.log("Price selected: ",a),console.log("Tax rate=: "+b),console.log("Tax policy=: "+y),console.log("Composition price final: ",c),e.contentWindow.postMessage({messageId:t.messageId,zakekeMessageType:"Price",message:a[0].price*o+c},"*")},S=function(e){var t=0,r=y,a=b,c=o[i];return t=1==r?e:e+e*a/100,n=t*=c,t},w=function(e){try{JSON.parse(e)}catch(e){return!1}return!0}}()}]);